# Vulnerability Management Process - Family Hub

**Version:** 1.0  
**Date:** 2025-12-20  
**Status:** Implementation Ready  
**Author:** Security Team (Penetration Tester)

---

## Executive Summary

This document defines the vulnerability management lifecycle for Family Hub, including vulnerability discovery, classification, remediation SLAs, disclosure policy, and continuous improvement processes. Given the sensitive nature of family data, a robust vulnerability management process is critical to maintaining user trust and regulatory compliance.

**Key Principles:**

- **Proactive Detection**: Automated scanning and manual testing
- **Rapid Response**: Clear SLAs based on severity
- **Transparent Disclosure**: Responsible disclosure policy
- **Continuous Improvement**: Learn from vulnerabilities

---

## Table of Contents

1. [Vulnerability Discovery](#1-vulnerability-discovery)
2. [Severity Classification](#2-severity-classification)
3. [Remediation SLAs](#3-remediation-slas)
4. [Vulnerability Workflow](#4-vulnerability-workflow)
5. [Disclosure Policy](#5-disclosure-policy)
6. [Bug Bounty Program](#6-bug-bounty-program)

---

## 1. Vulnerability Discovery

### 1.1 Discovery Channels

**Internal Discovery:**

| Channel | Frequency | Owner | Tool/Method |
|---------|-----------|-------|-------------|
| **Automated SAST** | Every commit | CI/CD Pipeline | SonarQube |
| **Dependency Scanning** | Daily | CI/CD Pipeline | Dependabot, npm audit, OWASP Dependency-Check |
| **Container Scanning** | Every build | CI/CD Pipeline | Trivy |
| **IaC Scanning** | Every commit | CI/CD Pipeline | Checkov |
| **DAST** | Weekly (staging) | Security Team | OWASP ZAP |
| **Manual Code Review** | Sprint-end | Development Team | Peer review |
| **Penetration Testing** | Annually | External Firm | Manual + automated |
| **Security Monitoring** | Continuous | SRE Team | Prometheus alerts |

**External Discovery:**

| Channel | Response Time | Owner |
|---------|---------------|-------|
| **Security Researcher Reports** | < 24 hours | Security Lead |
| **Bug Bounty Program** | < 48 hours | Security Team |
| **CVE Notifications** | < 24 hours | Security Lead |
| **User Reports** | < 48 hours | Support Team → Security |

### 1.2 Vulnerability Intake Process

**Step 1: Initial Triage** (< 4 hours)

- Assign unique vulnerability ID (VULN-YYYY-NNNN)
- Acknowledge receipt to reporter
- Assess if vulnerability is valid
- Determine initial severity (preliminary)

**Step 2: Validation** (< 24 hours)

- Reproduce vulnerability in staging environment
- Confirm impact and exploitability
- Re-assess severity using CVSS scoring
- Assign owner (developer/security engineer)

**Step 3: Documentation** (< 24 hours)

- Create GitHub Security Advisory (private)
- Document proof-of-concept
- Identify affected versions/components
- Determine root cause

---

## 2. Severity Classification

### 2.1 CVSS Scoring

**CVSS v3.1 Calculator:** https://www.first.org/cvss/calculator/3.1

**Base Metrics:**

- **Attack Vector (AV)**: Network, Adjacent, Local, Physical
- **Attack Complexity (AC)**: Low, High
- **Privileges Required (PR)**: None, Low, High
- **User Interaction (UI)**: None, Required
- **Scope (S)**: Unchanged, Changed
- **Confidentiality (C)**: None, Low, High
- **Integrity (I)**: None, Low, High
- **Availability (A)**: None, Low, High

**Severity Levels:**

| CVSS Score | Severity | Priority | Examples |
|------------|----------|----------|----------|
| **9.0 - 10.0** | **Critical** | P0 | Authentication bypass, remote code execution, mass data breach |
| **7.0 - 8.9** | **High** | P1 | SQL injection, privilege escalation, sensitive data exposure |
| **4.0 - 6.9** | **Medium** | P2 | XSS, CSRF, information disclosure, authorization bypass (limited scope) |
| **0.1 - 3.9** | **Low** | P3 | Security misconfiguration, verbose error messages, weak TLS config |
| **0.0** | **Informational** | P4 | Security best practice recommendations |

### 2.2 Business Impact Assessment

**Additional Factors (beyond CVSS):**

- **Data Sensitivity**: Does it expose health/financial data? (+1 severity level)
- **User Impact**: Number of users affected (>1000 users = +1 severity)
- **Exploit Availability**: Public exploit available? (+1 severity)
- **Attack Surface**: Internet-facing? (+0.5 severity)
- **Compliance Impact**: GDPR/HIPAA violation? (+1 severity)

**Example: SQL Injection in Health Service**

- CVSS Base Score: 8.5 (High)
- Health data exposed: +1 → **Critical**
- GDPR violation: +1 → **Critical (Priority P0)**

### 2.3 Severity Examples

**Critical (CVSS 9.0+):**

- Remote code execution on any production server
- Authentication bypass allowing full admin access
- Mass data exfiltration (>1000 user records)
- GraphQL query exposing all family groups' data

**High (CVSS 7.0-8.9):**

- SQL injection in any service
- Privilege escalation (child → admin role)
- XSS leading to session hijacking
- Sensitive data exposure in logs (health records)

**Medium (CVSS 4.0-6.9):**

- XSS without session hijacking potential
- CSRF on non-critical endpoints
- Information disclosure (software versions)
- Authorization bypass (limited scope)

**Low (CVSS 0.1-3.9):**

- Security misconfiguration (no direct exploit)
- Verbose error messages
- Missing security headers (CSP, HSTS)
- Weak TLS configuration (supports TLS 1.2)

---

## 3. Remediation SLAs

### 3.1 SLA by Severity

| Severity | Acknowledgment | Fix Deadline | Deployment | Verification |
|----------|----------------|--------------|------------|--------------|
| **Critical** | 2 hours | **24 hours** | Immediate hotfix | < 48 hours |
| **High** | 4 hours | **7 days** | Next sprint | < 14 days |
| **Medium** | 24 hours | **30 days** | Planned sprint | < 45 days |
| **Low** | 48 hours | **90 days** | Technical debt backlog | < 120 days |
| **Informational** | 7 days | Best effort | Backlog | - |

**SLA Clock Starts:** When vulnerability is validated (not discovered)

**SLA Exceptions:**

- **Complex fixes requiring architecture changes**: +50% time extension (with approval)
- **Third-party dependency vulnerabilities**: SLA based on upstream fix availability
- **Zero-day vulnerabilities**: Emergency response (no SLA, immediate action)

### 3.2 Escalation Path

**If SLA at risk:**

1. **Day 1**: Developer notifies security lead
2. **Day 2**: Security lead escalates to engineering manager
3. **Day 3**: Engineering manager escalates to CTO
4. **Day 5**: Emergency all-hands to resolve

**Critical Vulnerability Escalation (Immediate):**

- Notify: Security Lead, CTO, Engineering Manager
- Create: War room Slack channel
- Schedule: Daily standup until resolved
- Communication: Hourly status updates

---

## 4. Vulnerability Workflow

### 4.1 Vulnerability Lifecycle

```
┌─────────────────────────────────────────────────────────────────┐
│                   Vulnerability Lifecycle                        │
└─────────────────────────────────────────────────────────────────┘

1. DISCOVERY
   - Source: SAST, DAST, researcher, user
   - Action: Create vulnerability record (VULN-YYYY-NNNN)
   ↓

2. TRIAGE
   - Validate: Reproduce in staging
   - Classify: Assign CVSS score
   - Assign: Developer + security engineer
   ↓

3. ANALYSIS
   - Root Cause: Why did this happen?
   - Impact: What data/users affected?
   - Exploitability: How easy to exploit?
   ↓

4. REMEDIATION
   - Fix: Develop and test patch
   - Review: Security code review
   - Test: Verify fix doesn't introduce regressions
   ↓

5. DEPLOYMENT
   - Staging: Deploy to staging first
   - Production: Deploy to production (hotfix if critical)
   - Monitoring: Watch for issues
   ↓

6. VERIFICATION
   - Retest: Confirm vulnerability is fixed
   - Regression: Ensure no new vulnerabilities introduced
   - Close: Mark vulnerability as resolved
   ↓

7. POST-MORTEM (Critical/High only)
   - Analysis: What went wrong?
   - Prevention: How to prevent similar vulnerabilities?
   - Documentation: Update secure coding guidelines
```

### 4.2 GitHub Security Advisory Workflow

**Create Security Advisory:**

```bash
# Navigate to GitHub repository
# Security tab → Advisories → New draft security advisory

Title: [VULN-2025-0001] SQL Injection in Calendar Service
CVE: Request CVE ID
Severity: High (CVSS 8.5)
Affected: versions 1.0.0 - 1.2.3
Fixed: version 1.2.4

Description:
A SQL injection vulnerability exists in the Calendar Service's event search functionality. Attackers can inject malicious SQL code via the `searchTerm` parameter, potentially leading to unauthorized data access.

Proof of Concept:
```graphql
query {
  searchEvents(searchTerm: "' OR 1=1--")
}
```

Remediation:
Upgrade to version 1.2.4 or apply patch from PR #123.

```

**Workflow:**

1. **Draft**: Private, visible to security team only
2. **Collaborate**: Add affected repositories, request CVE
3. **Fix**: Develop patch in private fork
4. **Test**: Verify fix in staging
5. **Publish**: Release patch and disclose vulnerability
6. **Notify**: Email affected users (if applicable)

### 4.3 Hotfix Process (Critical Vulnerabilities)

**Emergency Hotfix Workflow:**

```bash
# 1. Create hotfix branch from main
git checkout main
git pull
git checkout -b hotfix/vuln-2025-0001

# 2. Apply fix
# ... make code changes ...

# 3. Test fix
./run-security-tests.sh

# 4. Create PR with bypass for approval (emergency)
git commit -m "SECURITY FIX: SQL injection in Calendar Service (VULN-2025-0001)"
git push origin hotfix/vuln-2025-0001

# 5. Deploy to staging immediately
kubectl set image deployment/calendar-service \
  calendar-service=familyhub/calendar-service:hotfix-vuln-2025-0001 \
  -n family-hub-staging

# 6. Monitor staging for 30 minutes
# ... watch logs and metrics ...

# 7. Deploy to production
kubectl set image deployment/calendar-service \
  calendar-service=familyhub/calendar-service:hotfix-vuln-2025-0001 \
  -n family-hub

# 8. Verify fix in production
./verify-fix.sh

# 9. Merge to main
git checkout main
git merge --no-ff hotfix/vuln-2025-0001
git tag -a v1.2.4 -m "Security hotfix: VULN-2025-0001"
git push origin main --tags
```

**Hotfix Approval:**

- **Critical**: CTO approval (verbal OK, formalize later)
- **High**: Security Lead + Engineering Manager approval
- **Medium/Low**: Standard PR approval process

---

## 5. Disclosure Policy

### 5.1 Responsible Disclosure Guidelines

**For Security Researchers:**

We welcome security researchers to report vulnerabilities responsibly. We commit to:

- **No Legal Action**: We will not pursue legal action against researchers who follow responsible disclosure
- **Acknowledgment**: Public credit (if desired) in security advisory
- **Bug Bounty**: Rewards for qualifying vulnerabilities (Phase 6+)

**How to Report:**

1. **Email**: security@familyhub.yourdomain.com (PGP key available)
2. **Encrypted**: Use PGP for sensitive details
3. **Include**:
   - Vulnerability description
   - Affected component/version
   - Proof-of-concept (screenshots, curl commands)
   - Suggested fix (optional)

**What NOT to do:**

- ❌ Do not publicly disclose before we've had time to fix (90 days)
- ❌ Do not exploit beyond proof-of-concept
- ❌ Do not access/modify user data
- ❌ Do not perform DoS attacks
- ❌ Do not test in production (use staging if possible)

### 5.2 Disclosure Timeline

**Standard Disclosure Process:**

```
Day 0: Vulnerability reported
  ↓
Day 1: Acknowledgment sent to reporter
  ↓
Day 2-7: Validation and severity assessment
  ↓
Day 7: Status update to reporter (fix ETA)
  ↓
Day 7-90: Fix development and testing
  ↓
Day 90: Deploy fix to production
  ↓
Day 91: Public disclosure (CVE, security advisory)
  ↓
Day 91+: Credit researcher in advisory (if desired)
```

**Expedited Disclosure (Critical):**

- Fix deployed within 24 hours
- Public disclosure 48 hours after fix
- Coordinate with reporter on timeline

**Delayed Disclosure:**

- If fix requires significant architecture changes, request 30-60 day extension from reporter
- Provide regular progress updates

### 5.3 Public Security Advisory Template

```markdown
# Security Advisory: SQL Injection in Calendar Service (VULN-2025-0001)

**Published:** 2025-12-20
**Severity:** High (CVSS 8.5)
**CVE:** CVE-2025-12345
**Affected Versions:** 1.0.0 - 1.2.3
**Fixed Versions:** 1.2.4+

## Summary

A SQL injection vulnerability was discovered in the Calendar Service's event search functionality. Authenticated attackers could inject malicious SQL code via the `searchTerm` parameter, potentially gaining unauthorized access to calendar events belonging to other families.

## Impact

- **Confidentiality**: HIGH - Attackers could read calendar events from other family groups
- **Integrity**: LOW - Attackers could not modify data
- **Availability**: LOW - No denial of service risk

## Affected Components

- Calendar Service (versions 1.0.0 - 1.2.3)
- API Gateway (versions forwarding requests to affected Calendar Service)

## Remediation

**Immediate action required:**

1. Upgrade to version 1.2.4 or later
2. Restart all Calendar Service pods

```bash
# Kubernetes upgrade
kubectl set image deployment/calendar-service \
  calendar-service=familyhub/calendar-service:1.2.4 \
  -n family-hub
```

## Technical Details

The vulnerability exists in `CalendarService/Controllers/SearchController.cs`:

```csharp
// VULNERABLE CODE (versions 1.0.0 - 1.2.3)
public async Task<IActionResult> SearchEvents(string searchTerm)
{
    var query = $"SELECT * FROM calendar.events WHERE title LIKE '%{searchTerm}%'";
    return await _db.QueryAsync(query);
}

// FIXED CODE (version 1.2.4+)
public async Task<IActionResult> SearchEvents(string searchTerm)
{
    var query = "SELECT * FROM calendar.events WHERE title LIKE @searchTerm";
    return await _db.QueryAsync(query, new { searchTerm = $"%{searchTerm}%" });
}
```

## Credit

This vulnerability was responsibly disclosed by [Researcher Name] on 2025-11-15.

## Timeline

- **2025-11-15**: Vulnerability reported
- **2025-11-16**: Vulnerability validated
- **2025-11-20**: Fix developed and tested
- **2025-11-22**: Fix deployed to production
- **2025-12-20**: Public disclosure (90 days)

## References

- CVE-2025-12345: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-12345
- Fix PR: https://github.com/yourorg/family-hub/pull/123
- OWASP SQL Injection: https://owasp.org/www-community/attacks/SQL_Injection

```

---

## 6. Bug Bounty Program

### 6.1 Program Scope (Phase 6+)

**Launch Timeline:** After successful Phase 5 penetration test

**Platform:** HackerOne or Bugcrowd

**In-Scope Assets:**

- Production frontend: `https://familyhub.yourdomain.com`
- Production API: `https://api.familyhub.yourdomain.com`
- Mobile apps: iOS and Android (future)

**Out-of-Scope:**

- Staging/development environments
- Third-party services (Zitadel, cloud provider)
- Physical security
- Social engineering
- Denial of Service (DoS/DDoS)

**Eligible Vulnerabilities:**

- Authentication/authorization bypass
- SQL injection
- XSS (stored, reflected, DOM-based)
- CSRF
- Server-side request forgery (SSRF)
- Remote code execution
- Sensitive data exposure
- Business logic flaws

**Ineligible Vulnerabilities:**

- Self-XSS
- Open redirects (unless chained with another vulnerability)
- Clickjacking (unless impactful)
- Missing rate limiting (unless DoS demonstrated)
- Information disclosure (unless sensitive)

### 6.2 Reward Structure

**Bounty Rewards:**

| Severity | Minimum | Typical | Maximum |
|----------|---------|---------|---------|
| **Critical** | $1,000 | $2,500 | $5,000 |
| **High** | $500 | $1,000 | $2,000 |
| **Medium** | $100 | $250 | $500 |
| **Low** | $50 | $100 | $250 |

**Bonus Multipliers:**

- **First to report**: +20%
- **High-quality report** (detailed PoC, fix suggestion): +10%
- **Severe business impact**: +50%

**Annual Budget:** $10,000 (Phase 6+)

### 6.3 Responsible Disclosure Agreement

**Researcher agrees to:**

- Not disclose vulnerability publicly before 90 days
- Not exploit vulnerability beyond proof-of-concept
- Not access/modify user data
- Not perform DoS attacks
- Provide sufficient detail for reproduction

**Family Hub agrees to:**

- Acknowledge report within 48 hours
- Provide regular status updates (weekly)
- Fix critical vulnerabilities within 24 hours
- Fix high vulnerabilities within 7 days
- Credit researcher in security advisory (if desired)
- Pay bounty within 30 days of fix deployment

---

## Appendix A: Vulnerability Tracking Template

**Vulnerability Record:**

```yaml
Vulnerability ID: VULN-2025-0001
Title: SQL Injection in Calendar Service Search
Reported Date: 2025-11-15
Reporter: security.researcher@example.com
Status: FIXED
Severity: High (CVSS 8.5)

Affected Components:
  - Calendar Service (v1.0.0 - v1.2.3)
  - API Gateway (v1.0.0 - v1.2.3)

CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:L

Timeline:
  - 2025-11-15: Reported
  - 2025-11-16: Validated (CVSS 8.5)
  - 2025-11-16: Assigned to dev-team
  - 2025-11-20: Fix developed (PR #123)
  - 2025-11-21: Fix tested in staging
  - 2025-11-22: Fix deployed to production (v1.2.4)
  - 2025-11-23: Retest completed (PASS)
  - 2025-12-20: Public disclosure

Fix:
  - PR: https://github.com/yourorg/family-hub/pull/123
  - Commit: abc123def456
  - Release: v1.2.4

CVE: CVE-2025-12345
CWE: CWE-89 (SQL Injection)

Lessons Learned:
  - Root Cause: Unsanitized user input in SQL query
  - Prevention: Use parameterized queries (all services)
  - Detection: Add SAST rule for string concatenation in SQL queries
```

---

## Appendix B: Security Metrics Dashboard

**Key Metrics to Track:**

| Metric | Target | Current |
|--------|--------|---------|
| **Vulnerabilities Detected (Monthly)** | - | - |
| **Mean Time to Acknowledge (MTTA)** | < 24 hours | - |
| **Mean Time to Remediate (Critical)** | < 24 hours | - |
| **Mean Time to Remediate (High)** | < 7 days | - |
| **Mean Time to Remediate (Medium)** | < 30 days | - |
| **SLA Compliance Rate** | > 95% | - |
| **Open Critical Vulnerabilities** | 0 | - |
| **Open High Vulnerabilities** | < 3 | - |
| **Vulnerability Backlog Age** | < 90 days (avg) | - |
| **False Positive Rate** | < 10% | - |
| **Bug Bounty Payout (Monthly)** | - | - |

**Grafana Dashboard Query Examples:**

```promql
# Count open vulnerabilities by severity
count(vulnerabilities{status="open"}) by (severity)

# Mean time to remediate (critical)
avg_over_time(vulnerability_remediation_duration_seconds{severity="critical"}[30d])

# SLA compliance rate
(count(vulnerabilities{sla_met="true"}) / count(vulnerabilities)) * 100
```

---

**Document Status:** Implementation Ready  
**Last Updated:** 2025-12-20  
**Next Review:** Quarterly  
**Maintained By:** Security Team

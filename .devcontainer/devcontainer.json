{
  "name": "Family Hub Development",
  "dockerComposeFile": [
    "../infrastructure/docker/docker-compose.yml",
    "docker-compose.devcontainer.yml"
  ],
  "service": "devcontainer",
  "workspaceFolder": "/workspace",

  "features": {
    "ghcr.io/devcontainers/features/dotnet:2": {
      "version": "10.0"
    },
    "ghcr.io/devcontainers/features/node:1": {
      "version": "22"
    },
    "ghcr.io/devcontainers/features/github-cli:1": {},
    "ghcr.io/devcontainers/features/docker-in-docker:2": {}
  },

  "customizations": {
    "vscode": {
      "extensions": [
        "ms-dotnettools.csdevkit",
        "ms-dotnettools.csharp",
        "Angular.ng-template",
        "ms-playwright.playwright",
        "bradlc.vscode-tailwindcss",
        "esbenp.prettier-vscode",
        "dbaeumer.vscode-eslint",
        "redhat.vscode-yaml",
        "humao.rest-client",
        "ms-azuretools.vscode-docker"
      ],
      "settings": {
        "editor.formatOnSave": true,
        "editor.defaultFormatter": "esbenp.prettier-vscode",
        "typescript.preferences.importModuleSpecifier": "relative",
        "dotnet.defaultSolution": "FamilyHub.sln"
      }
    }
  },

  "forwardPorts": [4200, 7000, 5432, 8080, 15672, 5341, 8025, 6379],

  "portsAttributes": {
    "4200": { "label": "Frontend (Angular)" },
    "7000": { "label": "Backend (GraphQL API)" },
    "5432": { "label": "PostgreSQL" },
    "8080": { "label": "Zitadel (OAuth)" },
    "15672": { "label": "RabbitMQ Management" },
    "5341": { "label": "Seq (Logging)" },
    "8025": { "label": "MailHog (Email)" },
    "6379": { "label": "Redis" }
  },

  "postCreateCommand": ".devcontainer/postCreateCommand.sh",

  "remoteEnv": {
    "DOTNET_WATCH_SUPPRESS_BROWSER_REFRESH": "true",
    "ConnectionStrings__DefaultConnection": "Host=postgres;Port=5432;Database=familyhub;Username=familyhub;Password=Dev123!",
    "RabbitMQ__Host": "rabbitmq",
    "Redis__ConnectionString": "redis:6379"
  }
}
